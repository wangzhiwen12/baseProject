<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,user-scalable=no" />
    <link rel="stylesheet" href="js/bootstrap-3.3.5-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="js/font/font-awesome-4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/style.css">
	<link href="css/center_conf.css" rel="stylesheet"/>
	<link href="css/base.css" rel="stylesheet"/>
	<link href="css/wxhome.css" rel="stylesheet" />
	<link href="css/ezr.css" rel="stylesheet"/>
	<link href="css/ezp-global.css" rel="stylesheet"/>
	<link href="css/wx-pc.css" rel="stylesheet"/>
	<link href="css/wx-card.css" rel="stylesheet"/>
	<link href="css/bootstrap-colorselector.css" rel="stylesheet"/>
    <title>绑定会员卡</title>
    <style type="text/css">
    	.input-border{
	    	width:70%;border:0px;background:none;
    	}
    	.input-border-date{
    		width:70%;border:0px;background:none;
    	}
    	.weui-vcode-btn{
    		display:inline-block;
    		border-left:1px solid #e5e5e5;
 			line-height:28px;
 			color:#3cc51f;
 			float: right;
 			background-color:transparent;
 			border-top:0;
 			border-right:0;
 			border-bottom:0;
 			outline:0;
 		}
    </style>
</head>
<body>
<div class="appphone_content" style="padding: 10px;" id="WxHeadHtml">
	<div>
	    <div class="appphone_content_navitem bg-normal-gray-310 text-left color-normal-gray-810" style="padding-left: 10px;height: 40px;line-height: 40px;">
	    </div>
	</div>
	<ul role="tablist" class="nav nav-tabs">
	    <li class="active" role="presentation" id="li-phone">
	        <a href="#ForPhone" aria-expanded="true" data-toggle="tab" role="tab"><span>按手机号</span></a>
	    </li>
	    <li role="presentation" id="li-card">
	        <a href="#ForIdCardNo" aria-expanded="true" data-toggle="tab" role="tab"><span>按会员卡号</span></a>
	    </li>
	</ul>
	<div style="background: #fff;padding:10px;margin-top: 10px;">
	                    <div class="tab-content clear-padding">
	                        <div class="tab-pane fade active in" id="ForPhone">
	                            <div class="appphone_content_navitem grid-nav-bar" id="phone-sjh">
	                                <div class="grid-nav-bar-item text-left" id="input-sjh">
	                                	<!-- border:0px;background:none; -->
	                                   	 <label style="width:25%;text-align: center;">手机号</label>
	                                   	 <input type="text" class="input-border" style="width: 40%;" id="input-content-sjh" />
	                                   	 <button class="weui-vcode-btn" style="float: right;" id="btnsmg" onclick="settime(this);" >&nbsp;&nbsp;获取验证码</button>
	                                </div>
	                            </div>
	                            <div class="appphone_content_navitem grid-nav-bar" id="phone-yzm">
	                                <div class="grid-nav-bar-item text-left" id="input-yzm">
	<label style="width:25%;text-align: center;">验证码</label><input type="text" id="input-content-yzm" class="input-border" />
	                                </div>
	                            </div>
	                            <div class="appphone_content_navitem grid-nav-bar" id="phone-sr">
	                                <div class="grid-nav-bar-item text-left" id="input-sr">
	                                   	 <label style="width:25%;text-align: center;">生&nbsp;&nbsp;&nbsp;&nbsp;日</label>
	                                   	 <!-- <input type="text" id="input-content-sr" class="input-border" /> -->
	                                   	 <input id="input-content-sr" type="date" class="input-border-date">
	                                </div>
	                            </div>
	                            <div class="appphone_content_navitem grid-nav-bar" id="phone-hykh">
	                                <div class="grid-nav-bar-item text-left" id="input-hykh">
	<label style="width:25%;text-align: center;">会员卡号</label><input type="text" id="input-content-hykh" class="input-border" />
	                                </div>
	                            </div>
	                            <div class="appphone_content_navitem grid-nav-bar" id="phone-pwd">
	                                <div class="grid-nav-bar-item text-left" id="input-pwd">
	<label style="width:25%;text-align: center;">密&nbsp;&nbsp;&nbsp;&nbsp;码</label><input type="password" id="input-content-pwd" class="input-border" />
	                                </div>
	                            </div>
	                        </div>
	                        <div class="tab-pane fade" id="ForIdCardNo">
	                            <div class="appphone_content_navitem grid-nav-bar" id="card-hykh">
	                                <div class="grid-nav-bar-item text-left" id="input-hykh-two">
	<label style="width:25%;text-align: center;">会员卡号</label><input type="text" id="input-content-hykh-two" class="input-border" />
	                                </div>
	                            </div>
	                            <div class="appphone_content_navitem grid-nav-bar" id="card-sfzh">
	                                <div class="grid-nav-bar-item text-left" id="input-sfzh">
	<label style="width:25%;text-align: center;">身份证号</label><input type="text" id="input-content-sfzh" class="input-border" />
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	                 <div style="margin-top: 10px">
	<button class="btn" type="button" style="width: 100%; background: #2b323a; color: white"> 立即绑定</button>
    </div>
</div>
</body>
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>
<script src="js/phoneCheckCode.js"></script>
<script src="js/public.js"></script>
<script type="text/javascript" src="/js/front/template.js"></script>
<script src="js/public.js"></script>
<script type="text/javascript">
var rootPath = getContextPath();
var storeCode = getUrlDataByKey("storeCode");
var openId = getUrlDataByKey("openId");

var rootPath = getContextPath();
var appId = getUrlDataByKey("appId");
var unionId= getUrlDataByKey("unionId");
var secret = getUrlDataByKey("secret");//appsecret秘钥
var registType= getUrlDataByKey("registType");
var bindType= getUrlDataByKey("bindType");
function reg(){
	//手机号，密码长度，会员卡号长度
	var reg = /^1[3|4|5|8][0-9]\d{4,8}$/;
	if(reg.test($("#input-content-sjh").val())){
		
	}else{
		alert("请输入正确的手机号");
		return false;
	}
}
var countdown=60;
function settime(obj) {
    if (countdown == 0) {
        obj.removeAttribute("disabled");
        obj.value="免费获取验证码";
        countdown = 60;
        return;
    } else {
        obj.setAttribute("disabled", true);
        $("#btnsmg").text("重新发送(" + countdown + ")");

        countdown--;
        if(countdown==0){
            $("#btnsmg").text("重新发送");
        }
    }
    setTimeout(function() {
                settime(obj) }
            ,1000)
}
$(function(){
	document.getElementById('input-content-sr').valueAsDate = new Date();
	$('#li-phone').click(function(){
		$('.input-border').val("");
	});
	$('#li-card').click(function(){
		$('.input-border').val("");
	});
	
	$('.btn').click(function(){
		reg();
			$.ajax({
				    type: 'post',
				    dataType: "json",
				    data: {
				    	"openId": openId,
			            "storeCode": storeCode,
			            "sjh":$("#input-content-sjh").val(),
			            "yzm":$("#input-content-yzm").val(),
			            "sr":$("#input-content-sr").val(),
			            "hykh":$("#input-content-hykh").val(),
			            "pwd":$("#input-content-pwd").val(),
			            "sfzh":$("#input-content-sfzh").val(),
			            "hykhTwo":$("#input-content-hykh-two").val()
			        },
				    url: rootPath + '/boundController/boundCard.shtml',
				    success: function(wxpageBound) {
				    	alert(wxpageBound);
				    	loadIndex();
				    }
			});
	});
	$.ajax({
	    type: 'post',
	    dataType: "json",
	    data: {
            "stroeCode": storeCode
        },
	    url: rootPath + '/boundController/getInfoByParam.shtml',
	    success: function(wxpageBound) {
	    	if(wxpageBound != null){
    			$('#WxHeadHtml *').remove();
    			var wxHeadHtml = wxpageBound.wxHeadHtml;
    			$('#WxHeadHtml').append(wxHeadHtml);
    			if($("#input-sr")){
    				var sr_input = '<input id="input-content-sr" type="date" class="input-border">';
	    			$("#input-sr").append(sr_input);
    			}
    			var yzm_btn = '<button class="weui-vcode-btn" style="float: right;" id="btnsmg" onclick="settime(this)">&nbsp;&nbsp;获取验证码</button>';
    			$('#input-sjh').append(yzm_btn);
    			document.getElementById('input-content-sr').valueAsDate = new Date();
    			$('#li-phone').click(function(){
    				$('.input-border').val("");
    			});
    			$('#li-card').click(function(){
    				$('.input-border').val("");
    			});
    			$('.btn').on("click", function(){
    				reg();
   					$.ajax({
          				    type: 'post',
          				    dataType: "json",
          				    data: {
          				    	"openId": openId,
          			            "storeCode": storeCode,
          			            "sjh":$("#input-content-sjh").val(),
          			            "yzm":$("#input-content-yzm").val(),
          			            "sr":$("#input-content-sr").val(),
          			            "hykh":$("#input-content-hykh").val(),
          			            "pwd":$("#input-content-pwd").val(),
          			            "sfzh":$("#input-content-sfzh").val(),
          			            "hykhTwo":$("#input-content-hykh-two").val()
          			        },
          				    url: rootPath + '/boundController/boundCard.shtml',
          				    success: function(wxpageBound) {
          				    	alert(wxpageBound);
          				    }
   					});
    			});
	    	}
	    }
	});
});
</script>
</html>